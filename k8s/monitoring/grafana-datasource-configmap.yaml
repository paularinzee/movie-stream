apiVersion: v1
kind: ConfigMap
metadata:
  name: movie-stream-dashboard
  namespace: monitoring
  labels:
    grafana_dashboard: "1"
data:
  movie-stream.json: |
    {
      "dashboard": {
        "id": null,
        "uid": "movie-stream-dashboard",
        "title": "Movie Stream App Metrics",
        "tags": ["movie-stream"],
        "panels": [
          {
            "type": "graph",
            "title": "API Request Rate",
            "targets": [
              {
                "expr": "rate(http_requests_total{job=\"movie-stream-api\"}[1m])",
                "legendFormat": "{{method}} {{path}}",
                "refId": "A"
              }
            ]
          },
          {
            "type": "graph",
            "title": "Memory Usage",
            "targets": [
              {
                "expr": "container_memory_usage_bytes{pod=~\"movie-stream-api.*\"}",
                "legendFormat": "{{pod}}",
                "refId": "B"
              }
            ]
          }
        ]
      }
    }
